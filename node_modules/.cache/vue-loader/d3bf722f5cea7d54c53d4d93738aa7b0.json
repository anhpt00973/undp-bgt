{"remainingRequest":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\vuejs-sourcode\\undp-bgt\\src\\views\\FormTaoBaoCao.vue?vue&type=style&index=0&id=0803dc35&lang=scss&","dependencies":[{"path":"F:\\vuejs-sourcode\\undp-bgt\\src\\views\\FormTaoBaoCao.vue","mtime":1665311455939},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\css-loader\\dist\\cjs.js","mtime":1665053118453},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1665053120726},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\postcss-loader\\src\\index.js","mtime":1665053119174},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1665053118004},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1665053118014},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\vue-loader\\lib\\index.js","mtime":1665053120378}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi53cmFwLXNlbGVjdC1sb2FpYmFvY2FvOjotd2Via2l0LXNjcm9sbGJhci10cmFjawp7CiAgLXdlYmtpdC1ib3gtc2hhZG93OiBpbnNldCAwIDAgNnB4IHJnYmEoMCwwLDAsMC4zKTsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjRjVGNUY1OwogIGJvcmRlci1yYWRpdXM6IDVweDsKfQoKLndyYXAtc2VsZWN0LWxvYWliYW9jYW86Oi13ZWJraXQtc2Nyb2xsYmFyCnsKICB3aWR0aDogMTBweDsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjRjVGNUY1Owp9Cgoud3JhcC1zZWxlY3QtbG9haWJhb2Nhbzo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIKewogIGJvcmRlci1yYWRpdXM6IDVweDsKICBiYWNrZ3JvdW5kLWltYWdlOiAtd2Via2l0LWdyYWRpZW50KGxpbmVhciwKICAgIGxlZnQgYm90dG9tLAogICAgbGVmdCB0b3AsCiAgICBjb2xvci1zdG9wKDAuNDQsIHJnYigxMjIsMTUzLDIxNykpLAogICAgY29sb3Itc3RvcCgwLjcyLCByZ2IoNzMsMTI1LDE4OSkpLAogICAgY29sb3Itc3RvcCgwLjg2LCByZ2IoMjgsNTgsMTQ4KSkpOwp9Cg=="},{"version":3,"sources":["FormTaoBaoCao.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqjBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FormTaoBaoCao.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <v-card\r\n    class=\"mx-auto pa-3\" style=\"padding-bottom: 40px !important;\"\r\n    flat\r\n  >\r\n    <v-row justify=\"end\" class=\"mt-0 mb-0 mx-0\" style=\"border-bottom: 1px solid #2161B1\">\r\n      <v-col class=\"d-flex align-center justify-start py-0 px-0\" style=\"color: #2161B1;font-weight: 500;\">\r\n        <div class=\"header-content\">\r\n          TẠO BÁO CÁO\r\n        </div>\r\n        <div class=\"triangle-header\"></div>\r\n      </v-col>\r\n      <v-spacer></v-spacer>\r\n    </v-row>\r\n    <v-form\r\n      ref=\"formTaoBaoCao\"\r\n      v-model=\"validFormAdd\"\r\n      lazy-validation\r\n      class=\"mt-2\"\r\n    >\r\n      <v-layout wrap>\r\n        <v-col cols=\"12\" md=\"4\" class=\"py-0 mb-2\">\r\n          <label>Kỳ báo cáo <span class=\"red--text\">(*)</span></label>\r\n          <v-autocomplete\r\n            class=\"flex input-form\"\r\n            hide-no-data\r\n            v-model=\"kyBaoCao\"\r\n            :items=\"kyBaoCaoItems\"\r\n            item-text=\"tenMuc\"\r\n            item-value=\"maMuc\"\r\n            :rules=\"required\"\r\n            required\r\n            dense\r\n            solo\r\n            hide-details=\"auto\"\r\n            return-object\r\n            clearable\r\n          >\r\n          </v-autocomplete>\r\n        </v-col>\r\n        <v-col cols=\"12\" md=\"4\" class=\"py-0 mb-2\">\r\n          <label>Năm báo cáo <span class=\"red--text\">(*)</span></label>\r\n          <v-autocomplete\r\n            class=\"flex input-form\"\r\n            hide-no-data\r\n            v-model=\"namBaoCao\"\r\n            :items=\"namBaoCaoItems\"\r\n            item-text=\"tenMuc\"\r\n            item-value=\"maMuc\"\r\n            :rules=\"required\"\r\n            required\r\n            dense\r\n            solo\r\n            hide-details=\"auto\"\r\n            return-object\r\n            clearable\r\n          >\r\n          </v-autocomplete>\r\n        </v-col>\r\n        <v-col cols=\"12\" md=\"4\" class=\"py-0 mb-2\">\r\n          <label>Hạn xử lý <span class=\"red--text\">(*)</span></label>\r\n          <v-text-field\r\n            class=\"flex input-form\"\r\n            v-model=\"hanXuLy\"\r\n            placeholder=\"dd/mm/yyyy, ddmmyyyy\"\r\n            @blur=\"formatBirthDate('hanXuLy')\"\r\n            @input=\"formatBirthDate('hanXuLy')\"\r\n            solo\r\n            dense\r\n            :rules=\"required\"\r\n            required\r\n            hide-details=\"auto\"\r\n            clearable\r\n          ></v-text-field>\r\n        </v-col>\r\n        <!--  -->\r\n        <v-col cols=\"12\" class=\"py-0 px-0 mb-2 col col-12 my-2\">\r\n          <div class=\"background-triangle-small\"> <v-icon size=\"20\" color=\"white\">mdi-view-dashboard-outline</v-icon></div>\r\n          Loại báo cáo  \r\n        </v-col>\r\n        <v-layout wrap class=\"px-0 py-2 mx-3 mt-2\" style=\"border: 1px solid #dedede\">\r\n          <v-col cols=\"12\" md=\"5\" class=\"py-0 mb-2\">\r\n            <label>Loại báo cáo <span class=\"red--text\">(*)</span></label>\r\n            <v-autocomplete\r\n              class=\"flex input-form\"\r\n              hide-no-data\r\n              v-model=\"nhomBaoCao\"\r\n              :items=\"danhSachNhomBaoCao\"\r\n              item-text=\"tenMuc\"\r\n              item-value=\"maMuc\"\r\n              dense\r\n              solo\r\n              hide-details=\"auto\"\r\n              return-object\r\n              clearable\r\n              @change=\"getDanhSachMauBaoCao\"\r\n            >\r\n            </v-autocomplete>\r\n          </v-col>\r\n          <v-col cols=\"12\" md=\"7\" class=\"mb-0 pt-3 pb-0\" style=\"align-self: center;\">\r\n            <v-btn small color=\"primary\" class=\"mx-2  text-white\" @click.native=\"toggleTatCaBaoCao('all')\" >\r\n              <v-icon left dark size=\"18\">\r\n                mdi-check-all\r\n              </v-icon>\r\n              Chọn tất cả\r\n            </v-btn>\r\n            <v-btn small color=\"primary\" class=\"mx-2  text-white\" @click.native=\"toggleTatCaBaoCao('null')\">\r\n              <v-icon left dark size=\"18\">\r\n                mdi-close-circle\r\n              </v-icon>\r\n              Bỏ tất cả\r\n            </v-btn>\r\n            <v-checkbox v-model=\"filterMauDaChon\" color=\"primary\" class=\"d-inline-flex\" hide-details style=\"margin-left: 30px;margin-top: 0\">\r\n              <template v-slot:label>Đã chọn &nbsp;<span style=\"color: green\">({{counterBaoCaoDaChon}})</span></template>\r\n            </v-checkbox>\r\n            <v-checkbox v-model=\"filterMauChuaChon\" color=\"primary\" class=\"d-inline-flex\" hide-details style=\"margin-left: 30px;margin-top: 0\">\r\n              <template v-slot:label>Chưa chọn &nbsp;<span style=\"color: red\">({{counterBaoCaoChuaChon}})</span></template>\r\n            </v-checkbox>\r\n          </v-col>\r\n        </v-layout>\r\n        <v-layout wrap class=\"px-0 py-2 mx-3 mt-0 wrap-select-loaibaocao mb-2\" style=\"width: 100%;border: 1px solid #dedede; border-top: 0px; max-height: 250px;overflow-y: auto;\">\r\n          <v-container fluid class=\"py-0\">\r\n            <v-checkbox\r\n              v-for=\"(item, index) in danhSachMauBaoCaoFilter\" :key=\"index\"\r\n              v-if=\"((!filterMauDaChon && !filterMauChuaChon) || (filterMauDaChon && item.hasOwnProperty('selected') && item.selected) || (filterMauChuaChon && !item.selected))\"\r\n              class=\"mb-3\"\r\n              hide-details\r\n              v-model=\"item.selected\"\r\n              :label=\"item.tenGoi\"\r\n              :value=\"true\"\r\n              @change=\"changeDanhSachMau\"\r\n            ></v-checkbox>\r\n          </v-container>\r\n        </v-layout>\r\n        <!--  -->\r\n        <v-col cols=\"12\" class=\"py-0 px-0 mb-2 col col-12 my-2\">\r\n          <div class=\"background-triangle-small\"> <v-icon size=\"20\" color=\"white\">mdi-view-dashboard-outline</v-icon></div>\r\n          Đơn vị được giao\r\n        </v-col>\r\n        <v-layout wrap class=\"px-0 py-2 mx-3 mt-2\" style=\"border: 1px solid #dedede\">\r\n          <v-col cols=\"12\" md=\"5\" class=\"py-0 mb-2\">\r\n            <label>Đơn vị được giao <span class=\"red--text\">(*)</span></label>\r\n            <v-autocomplete\r\n              class=\"flex input-form\"\r\n              hide-no-data\r\n              v-model=\"nhomDonViGiao\"\r\n              :items=\"danhSachNhomDonViGiao\"\r\n              item-text=\"tenMuc\"\r\n              item-value=\"maMuc\"\r\n              dense\r\n              solo\r\n              hide-details=\"auto\"\r\n              return-object\r\n              clearable\r\n              placeholder=\"Chọn nhóm đơn vị\"\r\n              @change=\"getDanhSachDonVi\"\r\n            >\r\n            </v-autocomplete>\r\n          </v-col>\r\n          <v-col cols=\"12\" md=\"7\" class=\"mb-0 pt-3 pb-0\" style=\"align-self: center;\">\r\n            <v-btn small color=\"primary\" class=\"mx-2  text-white\" @click.native=\"toggleTatCaDonVi('all')\" >\r\n              <v-icon left dark size=\"18\">\r\n                mdi-check-all\r\n              </v-icon>\r\n              Chọn tất cả\r\n            </v-btn>\r\n            <v-btn small color=\"primary\" class=\"mx-2  text-white\" @click.native=\"toggleTatCaDonVi('null')\">\r\n              <v-icon left dark size=\"18\">\r\n                mdi-close-circle\r\n              </v-icon>\r\n              Bỏ tất cả\r\n            </v-btn>\r\n            <v-checkbox v-model=\"filterDonViDaChon\" color=\"primary\" class=\"d-inline-flex\" hide-details style=\"margin-left: 30px;margin-top: 0\">\r\n              <template v-slot:label>Đã chọn &nbsp;<span style=\"color: green\">({{counterDonViDaChon}})</span></template>\r\n            </v-checkbox>\r\n            <v-checkbox v-model=\"filterDonViChuaChon\" color=\"primary\" class=\"d-inline-flex\" hide-details style=\"margin-left: 30px;margin-top: 0\">\r\n              <template v-slot:label>Chưa chọn &nbsp;<span style=\"color: red\">({{counterDonViChuaChon}})</span></template>\r\n            </v-checkbox>\r\n          </v-col>\r\n        </v-layout>\r\n        <v-layout wrap class=\"px-0 py-2 mx-3 mt-0 wrap-select-loaibaocao mb-2\" style=\"width: 100%;border: 1px solid #dedede; border-top: 0px; max-height: 250px;overflow-y: auto;\">\r\n          <v-container fluid class=\"py-0\">\r\n            <v-checkbox\r\n              v-for=\"(item, index) in danhSachDonViFilter\" :key=\"index\"\r\n              v-if=\"((!filterDonViDaChon && !filterDonViChuaChon) || (filterDonViDaChon && item.hasOwnProperty('selected') && item.selected) || (filterDonViChuaChon && !item.selected))\"\r\n              class=\"mb-3\"\r\n              hide-details\r\n              v-model=\"item.selected\"\r\n              :label=\"item.tenGoi\"\r\n              :value=\"true\"\r\n              @change=\"changeDanhSachDonVi\"\r\n            ></v-checkbox>\r\n\r\n          </v-container>\r\n        </v-layout>\r\n        <!--  -->\r\n        <v-col cols=\"12\" class=\"text-right my-3 mt-0\">\r\n          <!-- <v-btn small color=\"primary\" class=\"mt-0 mx-2  text-white\" @click.native=\"submitTaoBaoCao('create')\" :loading=\"loading\" :disabled=\"loading\">\r\n            <v-icon left dark size=\"20\">\r\n              mdi-file-document-plus-outline\r\n            </v-icon>\r\n            Tạo báo cáo\r\n          </v-btn> -->\r\n          <v-btn small color=\"primary\" class=\"mt-0 ml-2  text-white\" @click.native=\"submitTaoBaoCao('send')\" :loading=\"loading\" :disabled=\"loading\">\r\n            <v-icon left dark size=\"20\">\r\n              mdi-file-upload-outline\r\n            </v-icon>\r\n            Tạo và giao báo cáo\r\n          </v-btn>\r\n      </v-col>\r\n      </v-layout>\r\n    </v-form>\r\n    \r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nimport toastr from 'toastr'\r\ntoastr.options = {\r\n  'closeButton': true,\r\n  'timeOut': '5000',\r\n  \"positionClass\": \"toast-top-center\"\r\n}\r\nexport default {\r\n    props: [\"id\"],\r\n    components: {\r\n    },\r\n    data() {\r\n      return {\r\n        loading: false,\r\n        loadingData: false,\r\n        validFormAdd: false,\r\n        kyBaoCaoItems: [],\r\n        kyBaoCao: '',\r\n        namBaoCao: '',\r\n        hanXuLy: '',\r\n        danhSachNhomBaoCao: [],\r\n        nhomBaoCao: '',\r\n        danhSachMauBaoCao: [],\r\n        danhSachMauBaoCaoFilter: [],\r\n        danhSachNhomDonViGiao: [],\r\n        nhomDonViGiao: '',\r\n        danhSachDonVi: [],\r\n        danhSachDonViFilter: [],\r\n        filterMauChuaChon: false,\r\n        filterMauDaChon: false,\r\n        filterDonViChuaChon: false,\r\n        filterDonViDaChon: false,\r\n        counterBaoCaoDaChon: 0,\r\n        counterBaoCaoChuaChon: 0,\r\n        counterDonViDaChon: 0,\r\n        counterDonViChuaChon: 0,\r\n        required: [\r\n          v => (v !== '' && v !== null && v !== undefined) || 'Thông tin bắt buộc'\r\n        ],\r\n      }\r\n    },\r\n    created () {\r\n      let vm = this\r\n      if (!vm.isAdmin && !vm.checkRole('THEMMOIBAOCAO')) {\r\n        vm.$router.push({ path: '/login'})\r\n        return\r\n      }\r\n      vm.$store.commit('SET_INDEXTAB', 0)\r\n      vm.getDanhMuc('KYBAOCAO')\r\n      vm.getDanhMuc('NHOMBAOCAO')\r\n      vm.getDanhMuc('NHOMCOQUAN')\r\n      vm.getDanhSachMauBaoCao()\r\n      vm.getDanhSachDonVi()\r\n    },\r\n    computed: {\r\n      namBaoCaoItems() {\r\n        let arr = [];\r\n        let year = new Date().getFullYear();\r\n        for (let i = 0; i <= 19; i++) {\r\n          arr.push({ tenMuc: \"Năm \" + (year - i), maMuc: year - i });\r\n        }\r\n        return arr;\r\n      }\r\n    },\r\n    watch: {\r\n      '$route': function (newRoute, oldRoute) {\r\n        let vm = this\r\n        vm.$store.commit('SET_INDEXTAB', 0)\r\n      },\r\n      filterMauDaChon (val) {\r\n        if (val) {\r\n          this.filterMauChuaChon = false\r\n          let dataDaChon = this.danhSachMauBaoCao\r\n          this.danhSachMauBaoCaoFilter = [].concat(dataDaChon)\r\n        } else {\r\n          this.danhSachMauBaoCaoFilter = [].concat(this.danhSachMauBaoCao)\r\n        }\r\n      },\r\n      filterMauChuaChon (val) {\r\n        if (val) {\r\n          this.filterMauDaChon = false\r\n          let dataDaChon = this.danhSachMauBaoCao\r\n          this.danhSachMauBaoCaoFilter = [].concat(dataDaChon)\r\n        } else {\r\n          this.danhSachMauBaoCaoFilter = [].concat(this.danhSachMauBaoCao)\r\n        }\r\n      }\r\n    },\r\n    methods: {\r\n      getDanhMuc (collection) {\r\n        let vm = this\r\n        let filter = {\r\n          collectionName: 'dulieudanhmuc',\r\n          data: {\r\n            orderFields: 'maMuc',\r\n            orderTypes: 'asc',\r\n            page: 0,\r\n            size: 1000,\r\n            danhMuc_maDanhMuc: collection\r\n          }\r\n        }\r\n        vm.$store.dispatch('collectionFilter', filter).then(function (response) {\r\n          if (collection === 'KYBAOCAO') {\r\n            vm.kyBaoCaoItems = response.content\r\n          }\r\n          if (collection === 'NHOMBAOCAO') {\r\n            vm.danhSachNhomBaoCao = response.content\r\n          }\r\n          if (collection === 'NHOMCOQUAN') {\r\n            vm.danhSachNhomDonViGiao = response.content\r\n          }\r\n        }).catch(function () {\r\n        })\r\n      },\r\n      getDanhSachMauBaoCao () {\r\n        let vm = this\r\n        let filter = {\r\n          collectionName: 'maubaocao',\r\n          data: {\r\n            orderFields: 'tenGoi',\r\n            orderTypes: 'asc',\r\n            nhomBaoCao_maMuc: vm.nhomBaoCao ? vm.nhomBaoCao.maMuc : '',\r\n            page: 0,\r\n            size: 1000\r\n          }\r\n        }\r\n        vm.$store.dispatch('collectionFilter', filter).then(function (response) {\r\n          vm.danhSachMauBaoCao = response.content\r\n          vm.danhSachMauBaoCaoFilter = [].concat(vm.danhSachMauBaoCao)\r\n        }).catch(function () {\r\n        })\r\n      },\r\n      getDanhSachDonVi () {\r\n        let vm = this\r\n        let filter = {\r\n          collectionName: 'coquandonvi',\r\n          data: {\r\n            orderFields: 'tenGoi',\r\n            orderTypes: 'asc',\r\n            nhomCoQuan_maMuc: vm.nhomDonViGiao ? vm.nhomDonViGiao.maMuc : '',\r\n            page: 0,\r\n            size: 1000\r\n          }\r\n        }\r\n        vm.$store.dispatch('collectionFilter', filter).then(function (response) {\r\n          vm.danhSachDonVi = response.content\r\n          vm.danhSachDonViFilter = [].concat(vm.danhSachDonVi)\r\n        }).catch(function () {\r\n        })\r\n      },\r\n      changeDanhSachMau () {\r\n        let vm = this\r\n        if (vm.filterMauDaChon) {\r\n          vm.danhSachMauBaoCaoFilter = vm.danhSachMauBaoCao.filter(function (item) {\r\n            return item.hasOwnProperty('selected') && item.selected\r\n          })\r\n        }\r\n        if (vm.filterMauChuaChon) {\r\n          vm.danhSachMauBaoCaoFilter = vm.danhSachMauBaoCao.filter(function (item) {\r\n            return !item.selected\r\n          })\r\n        }\r\n        vm.counterBaoCaoDaChon = vm.danhSachMauBaoCao.filter(function (item) {\r\n          return item.hasOwnProperty('selected') && item.selected\r\n        }).length\r\n        vm.counterBaoCaoChuaChon = vm.danhSachMauBaoCao.filter(function (item) {\r\n          return !item.selected\r\n        }).length\r\n      },\r\n      toggleTatCaBaoCao (type) {\r\n        let vm = this\r\n        if (type === 'all') {\r\n          vm.danhSachMauBaoCao.forEach((element, index) => {\r\n            vm.danhSachMauBaoCao[index] = Object.assign(vm.danhSachMauBaoCao[index], {selected: true})\r\n          })\r\n          vm.danhSachMauBaoCaoFilter = [].concat(vm.danhSachMauBaoCao)\r\n        } else {\r\n          vm.danhSachMauBaoCao.forEach((element, index) => {\r\n            vm.danhSachMauBaoCao[index] = Object.assign(vm.danhSachMauBaoCao[index], {selected: null})\r\n          })\r\n          vm.danhSachMauBaoCaoFilter = [].concat(vm.danhSachMauBaoCao)\r\n        }\r\n        vm.counterBaoCaoDaChon = vm.danhSachMauBaoCao.filter(function (item) {\r\n          return item.hasOwnProperty('selected') && item.selected\r\n        }).length\r\n        vm.counterBaoCaoChuaChon = vm.danhSachMauBaoCao.filter(function (item) {\r\n          return !item.selected\r\n        }).length\r\n      },\r\n      changeDanhSachDonVi () {\r\n        let vm = this\r\n        if (vm.filterDonViDaChon) {\r\n          vm.danhSachDonViFilter = vm.danhSachDonVi.filter(function (item) {\r\n            return item.hasOwnProperty('selected') && item.selected\r\n          })\r\n        }\r\n        if (vm.filterMauChuaChon) {\r\n          vm.danhSachDonViFilter = vm.danhSachDonVi.filter(function (item) {\r\n            return !item.selected\r\n          })\r\n        }\r\n        vm.counterDonViDaChon = vm.danhSachDonVi.filter(function (item) {\r\n          return item.hasOwnProperty('selected') && item.selected\r\n        }).length\r\n        vm.counterDonViChuaChon = vm.danhSachDonVi.filter(function (item) {\r\n          return !item.selected\r\n        }).length\r\n      },\r\n      toggleTatCaDonVi (type) {\r\n        let vm = this\r\n        if (type === 'all') {\r\n          vm.danhSachDonVi.forEach((element, index) => {\r\n            vm.danhSachDonVi[index] = Object.assign(vm.danhSachDonVi[index], {selected: true})\r\n          })\r\n          vm.danhSachDonViFilter = [].concat(vm.danhSachDonVi)\r\n        } else {\r\n          vm.danhSachDonVi.forEach((element, index) => {\r\n            vm.danhSachDonVi[index] = Object.assign(vm.danhSachDonVi[index], {selected: null})\r\n          })\r\n          vm.danhSachDonViFilter = [].concat(vm.danhSachDonVi)\r\n        }\r\n        vm.counterDonViDaChon = vm.danhSachDonVi.filter(function (item) {\r\n          return item.hasOwnProperty('selected') && item.selected\r\n        }).length\r\n        vm.counterDonViChuaChon = vm.danhSachDonVi.filter(function (item) {\r\n          return !item.selected\r\n        }).length\r\n      },\r\n      submitTaoBaoCao (type) {\r\n        let vm = this\r\n        let mauBaoCaoChon = vm.danhSachMauBaoCao.filter(function(item) {\r\n          return item.hasOwnProperty('selected') && item.selected\r\n        })\r\n        let donViDaChon = vm.danhSachDonVi.filter(function(item) {\r\n          return item.hasOwnProperty('selected') && item.selected\r\n        })\r\n        if (!mauBaoCaoChon || !mauBaoCaoChon.length) {\r\n          toastr.error('Vui lòng chọn loại báo cáo')\r\n          return\r\n        }\r\n        if (!donViDaChon || !donViDaChon.length) {\r\n          toastr.error('Vui lòng chọn đơn vị')\r\n          return\r\n        }\r\n        \r\n        if (vm.loading) {\r\n          return\r\n        }\r\n        vm.loading = true\r\n        if (vm.$refs.formTaoBaoCao.validate()) {\r\n          vm.$store.commit('SET_SHOWCONFIRM', true)\r\n          let confirm = {\r\n            auth: false,\r\n            title: 'Xác nhận thao tác',\r\n            message: 'Bạn có chắc chắn thực hiện tạo mới ' + mauBaoCaoChon.length + ' báo cáo cho ' + donViDaChon.length + ' đơn vị',\r\n            button: {\r\n              yes: 'Có',\r\n              no: 'Không'\r\n            },\r\n            callback: () => {\r\n              let kybaocao = {\r\n                maMuc: vm.kyBaoCao['maMuc'],\r\n                tenMuc: vm.kyBaoCao['tenMuc']\r\n              }\r\n              let maubaocao = Array.from(mauBaoCaoChon, function (item) {\r\n                return {\r\n                  \"maDinhDanh\": item.maDinhDanh,\r\n                  \"maMauBaoCao\": item.maMauBaoCao,\r\n                  \"nhapNhieuThanhPhan\": item.nhapNhieuThanhPhan == 'true' ? 1 : 0\r\n                }\r\n              })\r\n              let donvi = Array.from(donViDaChon, function (item) {\r\n                return {\r\n                  \"maHanhChinh\": item.maHanhChinh,\r\n                  \"tenGoi\": item.tenGoi\r\n                }\r\n              })\r\n              let userInfo = vm.$cookies.get('UserInfo', '')\r\n              let tienTrinh = {\r\n                \"hoVaTen\": userInfo ? userInfo.hoVaTen : '',\r\n                \"thoiGianCapNhat\": (new Date()).toISOString(),\r\n                \"hanhDong\": \"Tạo báo cáo\",\r\n                \"noiDung\": \"\"\r\n              }\r\n              let filter = {\r\n                collectionName: 'baocao',\r\n                data: {\r\n                  \"kyBaoCao\": kybaocao,\r\n                  \"hanXuLy\": vm.convertDate(vm.hanXuLy),\r\n                  \"mauBaoCao\": maubaocao,\r\n                  \"coQuanThucHien\": donvi,\r\n                  \"namBaoCao\": vm.namBaoCao.maMuc,\r\n                  \"tienTrinh\": tienTrinh\r\n                }\r\n              }\r\n              console.log('dataBaoCao', filter.data)\r\n              vm.$store.dispatch('collectionCreate', filter).then(function (result) {\r\n                vm.loading = false\r\n                toastr.remove()\r\n                toastr.success('Tạo báo cáo thành công')\r\n                \r\n              }).catch(function (response) {\r\n                vm.loading = false\r\n                toastr.remove()\r\n                toastr.error('Thêm mới thất bại')\r\n              })\r\n            }\r\n          }\r\n          vm.$store.commit('SET_CONFIG_CONFIRM_DIALOG', confirm)\r\n        } else {\r\n          vm.loading = false\r\n        }\r\n      },\r\n      formatBirthDate (data) {\r\n        let vm = this\r\n        let lengthDate = String(vm[data]).trim().length\r\n        let splitDate = String(vm[data]).split('/')\r\n        if (lengthDate && lengthDate > 4 && splitDate.length === 3 && splitDate[2]) {\r\n          vm[data] = vm.translateDate(vm[data])\r\n        } else if (lengthDate && lengthDate === 8) {\r\n          let date = String(vm[data])\r\n          vm[data] = date.slice(0,2) + '/' + date.slice(2,4) + '/' + date.slice(4,8)\r\n        } else {\r\n          vm[data] = ''\r\n        }\r\n      },\r\n      translateDate (date) {\r\n        if (!date) return null\r\n        const [day, month, year] = date.split('/')\r\n        return `${day.padStart(2, '0')}/${month.padStart(2, '0')}/${year}`\r\n      },\r\n      dateLocale (dateInput) {\r\n        let date = new Date(dateInput)\r\n        return `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`\r\n      },\r\n      convertDate (date) {\r\n        if (!date) return ''\r\n        const [day, month, year] = date.split('/')\r\n        let ddd = `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`\r\n        return (new Date(ddd)).toISOString()\r\n      },\r\n      goBack () {\r\n        window.history.back()\r\n      }\r\n    }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n  .wrap-select-loaibaocao::-webkit-scrollbar-track\r\n  {\r\n    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);\r\n    background-color: #F5F5F5;\r\n    border-radius: 5px;\r\n  }\r\n\r\n  .wrap-select-loaibaocao::-webkit-scrollbar\r\n  {\r\n    width: 10px;\r\n    background-color: #F5F5F5;\r\n  }\r\n\r\n  .wrap-select-loaibaocao::-webkit-scrollbar-thumb\r\n  {\r\n    border-radius: 5px;\r\n    background-image: -webkit-gradient(linear,\r\n      left bottom,\r\n      left top,\r\n      color-stop(0.44, rgb(122,153,217)),\r\n      color-stop(0.72, rgb(73,125,189)),\r\n      color-stop(0.86, rgb(28,58,148)));\r\n  }\r\n</style>"]}]}