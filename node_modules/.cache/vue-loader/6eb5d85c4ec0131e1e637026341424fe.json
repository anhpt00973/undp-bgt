{"remainingRequest":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\vuejs-sourcode\\undp-bgt\\src\\views\\MauThongKe.vue?vue&type=style&index=0&id=2560ae87&lang=scss&","dependencies":[{"path":"F:\\vuejs-sourcode\\undp-bgt\\src\\views\\MauThongKe.vue","mtime":1665464457741},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\css-loader\\dist\\cjs.js","mtime":1665053118453},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1665053120726},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\postcss-loader\\src\\index.js","mtime":1665053119174},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1665053118004},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1665053118014},{"path":"F:\\vuejs-sourcode\\undp-bgt\\node_modules\\vue-loader\\lib\\index.js","mtime":1665053120378}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5iYW8tY2FvLTEgewogIHdpZHRoOiAzMDBweDsKICBtYXgtd2lkdGg6IDIzNXB4OwogIC8qIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjREREREREOyAqLwp9Ci5iYW8tY2FvLTEgLnYtbGlzdCB7CiAgcGFkZGluZy10b3A6IDBweDsKfQoubmF2LWNvbnRlbnQgewogIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNEREREREQ7CiAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAvLyBib3JkZXItcmFkaXVzOiA3cHg7CiAgaGVpZ2h0OiAxMDAlOwp9Cg=="},{"version":3,"sources":["MauThongKe.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MauThongKe.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <v-card\r\n      class=\"mx-auto pa-3\"\r\n      style=\"padding-bottom: 36px !important\"\r\n      flat\r\n    >   \r\n        <!-- title: Thống Kê Mẫu Báo Cáo -->\r\n        <v-row justify=\"end\" class=\"mt-0 mb-0 mx-0\" style=\"border-bottom: 1px solid #2161B1\">\r\n            <v-col class=\"d-flex align-center justify-start py-0 pl-0\" style=\"max-width: 300px;color: #2161B1;font-weight: 500;margin-bottom: -1px;\">\r\n                <div class=\"header-content \">\r\n                    Thống kê mẫu báo cáo\r\n                </div>\r\n                <div class=\"triangle-header\"></div>\r\n            </v-col>\r\n            <v-spacer></v-spacer>\r\n        </v-row>\r\n        \r\n        <!-- form: searchForm  -->\r\n        <v-form\r\n            ref=\"formThanhPhan\"\r\n            lazy-validation\r\n            class=\"mt-2\"\r\n        >\r\n            <v-layout wrap >\r\n                <div v-for=\"(item, index) in searchForm\" v-bind:key=\"index\" :class=\"item['fieldClass']\" class=\"py-0 mb-2\" >\r\n                  <label>{{item['title']}}</label>    \r\n                    <v-text-field\r\n                        v-if=\"item.type === 'textfield'\"\r\n                        class=\"flex input-form\"\r\n                        v-model=\"data[item['name']]\"\r\n                        :placeholder=\"item['placeHolder']\"\r\n                        solo\r\n                        dense\r\n                        hide-details=\"auto\"\r\n                        :rules=\"item.required ? [v => (v !== '' && v !== null && v !== undefined) || 'Thông tin bắt buộc'] : []\"\r\n                    ></v-text-field>\r\n                    <v-autocomplete\r\n                        v-if=\"item.type === 'select' && item['api']\"\r\n                        class=\"flex input-form\"\r\n                        hide-no-data\r\n                        v-model=\"data[item['name']]\"\r\n                        :items=\"item.dataSource\"\r\n                        :multiple=\"item['multiple']\"\r\n                        :item-text=\"item.itemText\"\r\n                        :item-value=\"item.itemValue\"\r\n                        dense\r\n                        solo\r\n                        hide-details=\"auto\"\r\n                        return-object\r\n                        :rules=\"item.required ? [v => (v !== '' && v !== null && v !== undefined) || 'Thông tin bắt buộc'] : []\"\r\n                    >\r\n                    </v-autocomplete>\r\n                </div>\r\n            </v-layout>\r\n\r\n            <v-row class=\"my-0 pr-3\">\r\n              <v-col cols=\"12\" class=\"d-flex align-center justify-end py-3 pb-0 my-0 pr-3\" >\r\n                <v-btn color=\"primary\" depressed small class=\"mx-0 text-white\" @click=\"\">\r\n                  <v-icon size=\"18\">mdi-magnify</v-icon>&nbsp;\r\n                  Tìm kiếm\r\n                </v-btn>\r\n              </v-col>\r\n            </v-row>\r\n\r\n        </v-form>\r\n        \r\n        <!-- table: render headers từ listViews -->\r\n        <v-row class=\"my-0 py-0 pt-3\">\r\n            <v-col cols=\"12\"  class=\"pt-0\">\r\n              <v-data-table\r\n                :headers=\"headers\"\r\n                :items=\"danhSachThanhPhan\"\r\n                :items-per-page=\"itemsPerPage\"\r\n                item-key=\"primKey\"\r\n                hide-default-footer\r\n                class=\"table-base mt-2\"\r\n                no-data-text=\"Không có\"\r\n                :loading=\"loadingData\"\r\n                loading-text=\"Đang tải... \"\r\n              >\r\n                <template v-slot:body=\"{ items, headers}\">\r\n                  <tbody>\r\n                    <tr v-for=\"(item, index) in items\" :key=\"index\" @click=\"showThongTinThanhPhan(item)\">\r\n                      <td v-for=\"(itemHeader, indexHeader) in headers\" :key=\"indexHeader\" :class=\"itemHeader['class']\" :width=\"itemHeader.hasOwnProperty('width') ? itemHeader.width : ''\">\r\n                        <div v-if=\"itemHeader.type == 'index'\">\r\n                          <div v-if=\"itemsPerPage\" :style=\"itemHeader.hasOwnProperty('style') ? itemHeader.style : ''\">{{ (page+1) * itemsPerPage - itemsPerPage + index + 1 }}</div>\r\n                          <div v-else :style=\"itemHeader.hasOwnProperty('style') ? itemHeader.style : ''\">{{ index + 1 }}</div>\r\n                        </div>\r\n                        <div v-else-if=\"itemHeader.type == 'date'\" :style=\"itemHeader.hasOwnProperty('style') ? itemHeader.style : ''\">\r\n                          {{ item['noiDung'].hasOwnProperty(itemHeader.value) ? dateLocale(item['noiDung'][itemHeader.value]) : '' }}\r\n                        </div>\r\n                        <div v-else-if=\"itemHeader.type == 'datetime'\" :style=\"itemHeader.hasOwnProperty('style') ? itemHeader.style : ''\">\r\n                          {{ item['noiDung'].hasOwnProperty(itemHeader.value) ? dateLocaleTime(item['noiDung'][itemHeader.value]) : ''}}\r\n                        </div>\r\n                        <div v-else-if=\"itemHeader.type == 'object'\" :style=\"itemHeader.hasOwnProperty('style') ? itemHeader.style : ''\">\r\n                          {{ item['noiDung'].hasOwnProperty(itemHeader.value) ? item['noiDung'][itemHeader.value][itemHeader.mapping] : '' }}\r\n                        </div>\r\n                        <div v-else-if=\"itemHeader.type == 'money'\" :style=\"itemHeader.hasOwnProperty('style') ? itemHeader.style : ''\">\r\n                          {{ item['noiDung'].hasOwnProperty(itemHeader.value) ? currency(item['noiDung'][itemHeader.value]) : '' }}\r\n                        </div>\r\n                        <div v-else-if=\"itemHeader.type == 'array'\" :style=\"itemHeader.hasOwnProperty('style') ? itemHeader.style : ''\">\r\n                          {{ item['noiDung'].hasOwnProperty(itemHeader.value) ? convertDataArray(itemHeader, item['noiDung'][itemHeader.value]) : '' }}\r\n                        </div>\r\n                        <div v-else-if=\"itemHeader.type == 'calculator'\" :style=\"itemHeader.hasOwnProperty('style') ? itemHeader.style : ''\">\r\n                          {{ convertDataView(itemHeader, item['noiDung']) }}\r\n                        </div>\r\n                        <div v-else-if=\"itemHeader.type == 'action'\">\r\n                          <v-tooltip top >\r\n                            <template v-slot:activator=\"{ on, attrs }\">\r\n                              <v-btn @click.stop=\"showThongTinThanhPhan(item)\" color=\"#2161b1\" text icon class=\" mr-2\" v-bind=\"attrs\" v-on=\"on\">\r\n                                <v-icon size=\"18\">mdi-file-document-multiple-outline</v-icon>\r\n                              </v-btn>\r\n                            </template>\r\n                            <span>Chi tiết thành phần</span>\r\n                          </v-tooltip>\r\n                          <v-tooltip top v-if=\"isAdmin || checkRole('CAPNHATBAOCAO')\">\r\n                            <template v-slot:activator=\"{ on, attrs }\">\r\n                              <v-btn @click.stop=\"showUpdateThanhPhan(item)\" color=\"#2161b1\" text icon class=\" mr-2\" v-bind=\"attrs\" v-on=\"on\">\r\n                                <v-icon size=\"18\">mdi-pencil</v-icon>\r\n                              </v-btn>\r\n                            </template>\r\n                            <span>Sửa</span>\r\n                          </v-tooltip>\r\n                          <v-tooltip top v-if=\"isAdmin || checkRole('CAPNHATBAOCAO')\">\r\n                            <template v-slot:activator=\"{ on, attrs }\">\r\n                              <v-btn @click.stop=\"xoaThanhPhan(item)\" color=\"red\" text icon class=\"\" v-bind=\"attrs\" v-on=\"on\">\r\n                                <v-icon size=\"18\">mdi-delete</v-icon>\r\n                              </v-btn>\r\n                            </template>\r\n                            <span>Xóa</span>\r\n                          </v-tooltip>\r\n                        </div>\r\n                        <div v-else :style=\"itemHeader.hasOwnProperty('style') ? itemHeader.style : ''\">\r\n                          {{ item['noiDung'][itemHeader.value] }}\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  </tbody>\r\n                </template>\r\n              </v-data-table>\r\n              <pagination v-if=\"pageCount\" :pageInput=\"page\" :total=\"total\" :pageCount=\"pageCount\" @tiny:change-page=\"changePage\"></pagination>\r\n            </v-col>\r\n        </v-row>\r\n\r\n        <!--diaglog: popup lọc mẫu theo Loại & Mẫu -->\r\n        <v-dialog\r\n            max-width=\"900\"\r\n            v-model=\"dialogChonMauBaoCao\"\r\n            persistent\r\n            >\r\n            <v-card>\r\n                <v-toolbar\r\n                dark\r\n                color=\"primary\" class=\"px-3\"\r\n                >\r\n                    <v-toolbar-title>Chọn mẫu Báo Cáo</v-toolbar-title>\r\n                    <v-spacer></v-spacer>\r\n                    <v-toolbar-items>\r\n                        <v-btn\r\n                        small\r\n                        icon\r\n                        dark\r\n                        @click=\"dialogChonMauBaoCao = false\"\r\n                        >\r\n                        <v-icon>mdi-close</v-icon>\r\n                        </v-btn>\r\n                    </v-toolbar-items>\r\n                </v-toolbar>\r\n                \r\n                <v-card-text class=\"mt-5 px-2\">\r\n                    <v-form\r\n                        ref=\"formAddToChuc\"\r\n                        lazy-validation\r\n                    >\r\n                        <v-layout wrap>\r\n                            <v-col cols=\"12\" md=\"12\" class=\"py-0 mb-2\">\r\n                                <label>Loại báo cáo</label>\r\n                                <v-autocomplete\r\n                                    class=\"flex input-form mt-2\"\r\n                                    hide-no-data\r\n                                    label=\"Chọn loại báo cáo\"\r\n                                    :items=\"danhSachNhomBaoCao\"\r\n                                    v-model=\"nhomBaoCao\"\r\n                                    item-text=\"tenMuc\"\r\n                                    item-value=\"maMuc\"\r\n                                    dense\r\n                                    solo\r\n                                    hide-details=\"auto\"\r\n                                    clearable\r\n                                    return-object\r\n                                    @change=\"getDanhSachMauBaoCao\"\r\n\r\n                                >\r\n                                </v-autocomplete>\r\n                            </v-col>\r\n                            <v-col cols=\"12\" md=\"12\" class=\"py-0 mb-2\">\r\n                                <label>Mẫu báo cáo</label>\r\n                                <v-autocomplete\r\n                                class=\"flex input-form mt-2\"\r\n                                hide-no-data\r\n                                label=\"Chọn mẫu báo cáo\"\r\n                                :items=\"danhSachMauBaoCao\"\r\n                                v-model=\"mauBaoCao\"\r\n                                item-text=\"tenGoi\"\r\n                                item-value=\"maMauBaoCao\"\r\n                                dense\r\n                                solo\r\n                                hide-details=\"auto\"\r\n                                clearable\r\n                                return-object\r\n                                >\r\n                                </v-autocomplete>\r\n                            </v-col>\r\n                        </v-layout>\r\n                    </v-form>\r\n                </v-card-text>\r\n                \r\n                <v-card-actions class=\"justify-end pb-3\">                    \r\n                    <v-btn small class=\"mr-2\" color=\"primary\" @click=\"getDuLieuMauThongKe()\">\r\n                        <v-icon left>\r\n                            mdi-image-filter-center-focus-weak\r\n                        </v-icon>\r\n                        <span>Lọc mẫu</span>\r\n                    </v-btn>\r\n                </v-card-actions>\r\n\r\n            </v-card>\r\n        </v-dialog>\r\n\r\n    </v-card>\r\n</template>\r\n\r\n<script>\r\nimport Pagination from './Pagination.vue'\r\n\r\nexport default {\r\n    name: 'BaoCao',\r\n    components: {\r\n      Pagination,\r\n    },\r\n    props: ['id'],\r\n    data() {\r\n        return {\r\n            dialogChonMauBaoCao: true,\r\n            danhSachNhomBaoCao: [],\r\n            nhomBaoCao: '',\r\n            danhSachMauBaoCao: [],\r\n            mauBaoCao: '',\r\n            danhSachBaoCao: [],\r\n            searchForm: [],\r\n            validFormAdd: false,\r\n            data: {},\r\n            page: 0,\r\n            itemsPerPage: 0,\r\n            total: 0,\r\n            pageCount: 0,\r\n            loadingData: false,\r\n            danhSachThanhPhan: [],\r\n            headers: [],\r\n        }\r\n    },\r\n    created () {\r\n        let vm = this\r\n        if (!vm.isAdmin && !vm.checkRole('XEMBAOCAODONVI') && !vm.checkRole('XEMTATCABAOCAO')) {\r\n          vm.$router.push({ path: '/login'})\r\n          return\r\n        }\r\n        vm.loadDuLieuMauThongKe()\r\n        vm.getDanhMuc('NHOMBAOCAO')  \r\n        vm.getDanhSachMauBaoCao()    \r\n    },\r\n    watch: {\r\n        '$route': function (newRoute, oldRoute) {\r\n          let vm = this\r\n          vm.loadDuLieuMauThongKe()\r\n        }\r\n    },\r\n    methods: {\r\n      getDanhMuc (collection) {\r\n      let vm = this\r\n      let filter = {\r\n        collectionName: 'dulieudanhmuc',\r\n        data: {\r\n          orderFields: 'maMuc',\r\n          orderTypes: 'asc',\r\n          page: 0,\r\n          size: 1000,\r\n          danhMuc_maDanhMuc: collection\r\n        }\r\n      }\r\n      vm.$store.dispatch('collectionFilter', filter).then(function (response) {\r\n        if (collection === 'NHOMBAOCAO') {\r\n          vm.danhSachNhomBaoCao = response.content\r\n        }\r\n      }).catch(function () {\r\n      })\r\n      },\r\n      getDanhSachMauBaoCao () {\r\n          let vm = this\r\n          let filter = {\r\n          collectionName: 'maubaocao',\r\n          data: {\r\n              orderFields: 'tenGoi',\r\n              orderTypes: 'asc',\r\n              nhomBaoCao_maMuc: vm.nhomBaoCao ? vm.nhomBaoCao.maMuc : '',\r\n              page: 0,\r\n              size: 1000,\r\n          }\r\n          }\r\n          vm.$store.dispatch('collectionFilter', filter).then(function (response) {\r\n              vm.danhSachMauBaoCao = response.content\r\n          }).catch(function () {\r\n          })\r\n      },\r\n      loadDuLieuMauThongKe() {\r\n        let vm = this\r\n        console.log(typeof vm.id)\r\n        // if (vm.id !== 10) {\r\n        //   console.log(vm.id)\r\n        //   vm.dialogChonMauBaoCao = false\r\n        //   vm.getDuLieuMauThongKeTheoKey(vm.id)\r\n        //   setTimeout(function () {\r\n        //     vm.initForm()\r\n        //   }, 200)\r\n        // }\r\n      },\r\n      getDuLieuMauThongKe () {\r\n          let vm = this\r\n          vm.getDuLieuMauThongKeTheoKey(vm.mauBaoCao.maDinhDanh)\r\n          setTimeout(function () {\r\n            vm.initForm()\r\n          }, 200)\r\n          vm.$router.push({ path: '/thong-ke-mau-bao-cao/' + vm.mauBaoCao.maDinhDanh})\r\n          vm.dialogChonMauBaoCao = false\r\n      },\r\n      getDuLieuMauThongKeTheoKey (key) {\r\n          let vm = this\r\n          let filter = {\r\n            collectionName: 'maubaocao',\r\n            keySearch: 'madinhdanh',\r\n            id: key,\r\n          }\r\n          vm.$store.dispatch('collectionDetailSearch', filter).then(function (response) {\r\n            vm.thongKeMauBaoCao = response.resp\r\n            vm.headers = vm.thongKeMauBaoCao.mauThongKe[0].listView[0]['headers']\r\n            vm.searchForm = vm.thongKeMauBaoCao.mauThongKe[0]['searchForm']\r\n            vm.itemsPerPage = vm.chiTietMauBaoCao.mauHienThi[0].hasOwnProperty('itemsPerPage') ? vm.chiTietMauBaoCao.mauHienThi[0].itemsPerPage : 0\r\n            vm.getdanhSachThanhPhan()\r\n          }).catch(function () {\r\n          })\r\n      },\r\n      initForm (key) {\r\n        let vm = this\r\n        for (let key in vm.searchForm) {\r\n          let itemData = vm.searchForm[key]\r\n          if (itemData['type'] === 'select' && itemData.hasOwnProperty('api') && itemData['api']) {\r\n            vm.$store.dispatch('loadDataSource', itemData).then(function(result) {\r\n              let resultData = itemData['responseDataApi'] ? result[itemData['responseDataApi']] : result\r\n              vm.$set(vm.searchForm[key], 'dataSource', resultData)\r\n            }).catch(function(){})\r\n          }\r\n\r\n        }\r\n      },\r\n    }\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n  .bao-cao-1 {\r\n    width: 300px;\r\n    max-width: 235px;\r\n    /* border-bottom: 1px solid #DDDDDD; */\r\n  }\r\n  .bao-cao-1 .v-list {\r\n    padding-top: 0px;\r\n  }\r\n  .nav-content {\r\n    border-right: 1px solid #DDDDDD;\r\n    box-sizing: border-box;\r\n    // border-radius: 7px;\r\n    height: 100%;\r\n  }\r\n</style>\r\n"]}]}